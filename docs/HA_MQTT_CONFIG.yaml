# Home Assistant MQTT Switch Configurations for Knights ESP32
# Add this to your configuration.yaml

mqtt:
  switch:
    - name: "Knights Water Pump"
      unique_id: knights_water_pump
      command_topic: "vermilinks/knights/command"
      payload_on: '{"pump":"on"}'
      payload_off: '{"pump":"off"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.pump }}'
      state_on: "on"
      state_off: "off"
      optimistic: false
      qos: 1
      retain: false

    - name: "Knights Solenoid Valve 1 Pulse"
      unique_id: knights_valve1_pulse
      command_topic: "vermilinks/knights/command"
      payload_on: '{"valve1":"pulse"}'
      payload_off: '{"valve1":"off"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.valve1 }}'
      state_on: "on"
      state_off: "off"
      optimistic: true  # Since it's momentary
      qos: 1
      retain: false

    - name: "Knights Solenoid Valve 2 Pulse"
      unique_id: knights_valve2_pulse
      command_topic: "vermilinks/knights/command"
      payload_on: '{"valve2":"pulse"}'
      payload_off: '{"valve2":"off"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.valve2 }}'
      state_on: "on"
      state_off: "off"
      optimistic: true
      qos: 1
      retain: false

    - name: "Knights Solenoid Valve 3 Pulse"
      unique_id: knights_valve3_pulse
      command_topic: "vermilinks/knights/command"
      payload_on: '{"valve3":"pulse"}'
      payload_off: '{"valve3":"off"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.valve3 }}'
      state_on: "on"
      state_off: "off"
      optimistic: true
      qos: 1
      retain: false

    - name: "Knights Auto Mode"
      unique_id: knights_auto_mode
      command_topic: "vermilinks/knights/command"
      payload_on: '{"mode":"auto"}'
      payload_off: '{"mode":"manual"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.mode }}'
      state_on: "auto"
      state_off: "manual"
      optimistic: false
      qos: 1
      retain: false

    - name: "Knights Manual Mode"
      unique_id: knights_manual_mode
      command_topic: "vermilinks/knights/command"
      payload_on: '{"mode":"manual"}'
      payload_off: '{"mode":"auto"}'
      state_topic: "vermilinks/knights/status"
      value_template: '{{ value_json.mode }}'
      state_on: "manual"
      state_off: "auto"
      optimistic: false
      qos: 1
      retain: false

# Optional: MQTT sensors for monitoring
  sensor:
    - name: "Knights Float Sensor"
      unique_id: knights_float_sensor
      state_topic: "vermilinks/knights/data"
      value_template: '{{ value_json.metrics.floatSensor }}'
      unit_of_measurement: ""
      qos: 1

    - name: "Knights Water Level"
      unique_id: knights_water_level
      state_topic: "vermilinks/knights/data"
      value_template: '{{ value_json.metrics.waterLevel }}'
      unit_of_measurement: ""
      qos: 1

    - name: "Knights Device Uptime"
      unique_id: knights_uptime
      state_topic: "vermilinks/knights/data"
      value_template: '{{ value_json.metadata.uptime }}'
      unit_of_measurement: "s"
      qos: 1

    - name: "Knights WiFi Signal"
      unique_id: knights_wifi_signal
      state_topic: "vermilinks/knights/data"
      value_template: '{{ value_json.metadata.signal }}'
      unit_of_measurement: "dBm"
      qos: 1