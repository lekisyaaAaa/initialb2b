# Core Server
NODE_ENV=development
PORT=5000
LOG_LEVEL=info

# Database (PostgreSQL only)
# Example: postgresql://user:password@host/database?sslmode=require
DATABASE_URL=

# Security & Auth
JWT_SECRET=vermilinks_secret_2025
RESET_TOKEN_EXPIRY_MINUTES=15
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=5
ADMIN_SESSION_TTL_HOURS=2
ADMIN_OTP_TTL_MS=180000
ADMIN_REFRESH_TTL_MS=604800000
ADMIN_OTP_RETENTION_BUFFER_MS=3600000
ADMIN_OTP_CLEANUP_INTERVAL_MS=600000
ADMIN_LOGIN_MAX_ATTEMPTS=5
ADMIN_LOGIN_WINDOW_MS=900000
ADMIN_LOGIN_LOCKOUT_MS=900000
ADMIN_OTP_MAX_ATTEMPTS=5
ADMIN_OTP_WINDOW_MS=600000
ADMIN_OTP_LOCKOUT_MS=600000
ADMIN_OTP_RESEND_MAX_ATTEMPTS=3
ADMIN_OTP_RESEND_WINDOW_MS=600000
ADMIN_OTP_RESEND_LOCKOUT_MS=1800000

# Email / SMTP
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
EMAIL_USER=beantobin2025@gmail.com
EMAIL_PASS=
EMAIL_FROM="BeanToBin <beantobin2025@gmail.com>"
ADMIN_LOGIN_USERNAME=beantobin2025@gmail.com
ADMIN_LOGIN_PASSWORD=Bean2bin2025

# Frontend & Device Integration
# Comma separate when allowing multiple origins.
CORS_ORIGINS=http://localhost:3002,https://vermilinks.com,https://www.vermilinks.com
# CORS_ORIGIN= # optional legacy single-origin fallback
SOCKETIO_CORS_ORIGINS=https://vermilinks.com,https://www.vermilinks.com
# Legacy actuator integration (unused in dummy mode; leave blank unless hardware control returns)
ESP32_URL=
ESP32_COMMAND_TIMEOUT_MS=
PRIMARY_DEVICE_ID=vermilinks-esp32
COMMAND_RETRY_INTERVAL_MS=5000
COMMAND_RETRY_STALE_MS=15000

# Home Assistant Bridge
ENABLE_HOME_ASSISTANT_BRIDGE=false
HOME_ASSISTANT_BASE_URL=http://192.168.8.134:8123
# HOME_ASSISTANT_WS_URL=ws://192.168.8.134:8123/api/websocket
HOME_ASSISTANT_TOKEN=
# Map VermiLinks sensor fields to Home Assistant entity_ids. JSON or comma form (temperature=sensor.temp,...)
HOME_ASSISTANT_SENSOR_MAP='{"temperature":"sensor.vermilinks_temperature","humidity":"sensor.vermilinks_humidity","moisture":{"entity":"sensor.vermilinks_soil","attribute":"moisture"},"floatSensor":{"entity":"binary_sensor.vermilinks_float","type":"boolean"}}'
HOME_ASSISTANT_DEVICE_ID=vermilinks-homeassistant
HOME_ASSISTANT_WEBHOOK_SECRET=
HOME_ASSISTANT_WEBHOOK_RATE_LIMIT=30
HOME_ASSISTANT_HISTORY_DAYS=7
HOME_ASSISTANT_RAW_CACHE_LIMIT=8192
# Optional tuning controls
HOME_ASSISTANT_FLUSH_DEBOUNCE_MS=250
HOME_ASSISTANT_ALLOW_INSECURE_TLS=false
ALLOW_HOME_ASSISTANT_PUSH_WITHOUT_SOCKET=true

# Optional integrations
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# Alert threshold defaults (JSON string consumed at boot)
ALERT_THRESHOLDS_JSON='{"temperature":{"min":20,"max":30,"warning":32,"critical":35,"lowWarning":18,"lowCritical":15},"humidity":{"min":55,"max":70,"lowWarning":45,"warning":75},"ec":{"min":0.8,"max":2,"lowWarning":0.5,"warning":2.2,"critical":2.5},"nitrogen":{"minWarning":150,"minCritical":100,"maxWarning":600},"phosphorus":{"minWarning":20,"maxWarning":100},"potassium":{"minWarning":100,"maxWarning":350},"ph":{"idealMin":6.2,"idealMax":7,"minWarning":6,"minCritical":5.5,"maxWarning":7.5,"maxCritical":8},"floatSensor":{"normalState":1,"lowAlertState":0,"lowAlertDurationSec":90},"waterPump":{"maxRuntimeSec":300,"minRestSec":120,"minFlowLpm":2}}'

# Frontend build-time variables (configure in Render dashboard for the static site)
REACT_APP_API_URL=https://api.vermilinks.com/api
REACT_APP_WS_URL=wss://api.vermilinks.com
REACT_APP_SENSOR_POLL_INTERVAL_MS=5000
REACT_APP_DUMMY_MODE=true
REACT_APP_HOME_ASSISTANT_URL=https://homeassistant.local:8123
REACT_APP_ENABLE_SOCKETS=false
